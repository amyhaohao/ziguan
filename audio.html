<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/>
    <meta http-equiv="pragma" content="no-cache" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title></title>
    <style>
        body{margin: 0;padding:0 0 0 10px;font-size: 30px;}
        #time{display: none;}
        #words{height:100px;line-height: 30px; overflow-y: scroll;margin: 10px 0 15px;white-space: pre-wrap}  
        input{margin-left:0;width:55px;font-size: 30px;padding:0;}
        input[type="button"]{width:80px;padding:0;}
        .btns{display: none;}
        .btns a{display:inline-block;text-decoration: none;width:150px;line-height:150px;text-align: center;background: #aaa;border-radius: 5px;position: fixed;bottom:30px;}
        .btns i{border-style: solid;border-width: 40px;display: inline-block;vertical-align: middle}
        #prevBtn{left:8px;}
        #prevBtn i{border-color: transparent #fff transparent transparent;border-left-width: 0}
        #playBtn{right:8px;}
        #playBtn i{border-right-width: 0; border-color: transparent transparent transparent #fff;}
        .ios #time{display: block;position: absolute;left:80px;top:0px;}
        .ios #words{margin-top:40px;}
        .ios .btns{display: block;}
    </style>
</head>
<body>
<audio src="7.mp3?3" controls="controls" id="audio"></audio>
<div id="time"></div>
<input id="input1" type="number" pattern="[0-9]*"/>
<input id="input2" type="number" pattern="[0-9]*"/>
<input type="button" value="ok" onclick="go()"/>
<input type="button" value="save" onclick="save()"/>
<pre id="words">897
01:30:46,910 --> 01:30:48,500
光希

898
01:30:48,500 --> 01:30:49,790
茗子

899
01:30:50,290 --> 01:30:53,010
-好久不见 -好久不见

900
01:30:53,220 --> 01:30:55,150
-你还好吗 -很好啊</pre>
    <div class="btns">
        <a id="prevBtn"><i></i></a>
        <a id="playBtn"><i></i></a>
    </div>
<script>
    var ios = !!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
    if(ios)
        document.body.className = "ios";
    
    if(localStorage.time)  
        audio.oncanplay = function(){
            audio.currentTime = localStorage.time-0;
            audio.oncanplay = null;
        }
        
    setInterval(function(){
        var t = parseInt(audio.currentTime),
            seconds = t%60,
            min = (t-seconds)/60;
        time.innerHTML = min+":"+(seconds<10?"0":"")+seconds;
    }, 1000);    
    
    function prev(){
        audio.pause();
        audio.currentTime -= 2;
    }
    function play(){
        audio.paused?audio.play():audio.pause();
    }
    function down(){
        words.scrollTop += 20
    }
    function up(){
        words.scrollTop -= 20;
    }
    
    if(ios) {
        window.ontouchmove = function(e){
            e.preventDefault();
        }
        words.ontouchmove = function(e){
            e.stopPropagation();
        }
        prevBtn.ontouchend = prev;
        playBtn.ontouchend = play;
    }else {
        window.onkeypress = function(e){
        var k = e.key;
        if(k=="n")
            return prev();
        if(k==" ")
            return play();
        if(k=="j")
            return down();
        if(k=="i")
            return up();
        }
    }
    
    
    
    function go(){
        audio.currentTime = (input1.value-0)*60+(input2.value-0);
    }
    function save(){
        localStorage.time = audio.currentTime;
    }

    setTimeout(function(){
        input1.click();
    }, 5000);
</script>
</body>
</html>
